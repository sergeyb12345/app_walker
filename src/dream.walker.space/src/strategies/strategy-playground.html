<template>
    <strategy-admin></strategy-admin>

    <div class="c_playground-content">
        <div class="row">
            <div class="col-md-8 col-xs-12 c_playground">
                <header>
                    <h3 first-letter-span>Strategy Playground </h3>
                </header>

                <form>
                    <fieldset>
                        <div class="form-group">
                            <label>Selected Strategy</label>
                            <p class="form-control" readonly>${strategy.title}</p>
                        </div>

                        <div class="form-group">
                            <label>Selected Company</label>
                            <div class="input-group">
                                <p class="form-control" readonly>${company.ticker} - ${company.name}</p>
                                <div class="input-group-btn">
                                    <button type="button" if.bind="!company.show && !searchMode" click.delegate="company.show = true" class="btn btn-default">Show Details</button>
                                    <button type="button" click.delegate="searchMode = !!!searchMode" class="btn ${searchMode ? 'btn-default' : 'btn-danger'}">${searchMode ? 'Cancel' : 'Search'}</button>
                                </div>
                            </div>

                            <div class="c_company-details" if.bind="company.show">
                                <company-details company.bind="company"></company-details>

                                <div class="c_company-actions">
                                    <button type="button" click.delegate="updateCompany(company.ticker)" class="btn btn-danger">Update</button>
                                    <button type="button" click.delegate="company.show = false" class="btn btn-default">Hide</button>
                                </div>
                            </div>

                        </div>
                    </fieldset>
                </form>

                <div if.bind="searchMode" class="c_companies-content">
                    <form submit.delegate="searchCompanies()">
                        <fieldset>
                            <div class="form-inline right">
                                <label>Company Search: </label>

                                <div class="input-group">
                                    <input type="text" class="form-control uppercase" value.bind="searchCriteria" />
                                    <div class="input-group-btn">
                                        <button type="submit" disabled.bind="searchCriteria.length===0" class="btn btn-danger">Go</button>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </form>

                    <div class="c_company_list" if.bind="companies.length > 0">
                        <div repeat.for="company of companies" class="c_company ${$index === $parent.companies.length-1 ? 'no-border': ''}">
                            <div class="c_company-header">
                                <button type="button" click.trigger="selectCompany(company)" class="btn btn-warning btn-xs" >Select</button>
                                <span click.trigger="company.expanded = !!!company.expanded">
                                    <span>${company.ticker} - ${company.name}</span>
                                    <a class="chevron">
                                        <span class="glyphicon ${company.expanded ? 'glyphicon-menu-down' : 'glyphicon-menu-left'} " aria-hidden="true"></span>
                                    </a>
                                </span>                                
                            </div>
                            <div class="c_company-details" if.bind="company.expanded">
                                <company-details company.bind="company"></company-details>
                            </div>
                        </div>
                    </div>
                </div>

                <div if.bind="strategy.strategyId && company.ticker && !playgroundLoaded">
                    <div class="right">
                        <button type="button" click.delegate="loadPlayground()" class="btn btn-danger">Load Playground</button>
                    </div>
                </div>

                <div if.bind="playgroundLoaded">
                    <div class="o_chart">
                        <any-chart container.bind="chartWeeklyContainer"></any-chart>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-xs-12">
                <side-navigation strategyurl.bind="strategyUrl"></side-navigation>
            </div>
        </div>
    </div>

</template>